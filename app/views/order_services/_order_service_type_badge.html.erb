<% if record&.order_service_type.present? %>
  <%
    badge_class = case record.order_service_type_id
    when OrderServiceType::DIAGNOSTICO_ID
      'badge-os-diagnostico'
    when OrderServiceType::COTACOES_ID
      'badge-os-cotacoes'
    when OrderServiceType::REQUISICAO_ID
      'badge-os-requisicao'
    else
      'bg-secondary'
    end
  %>

  <span class="badge <%= badge_class %>">
    <%= record.order_service_type.name %>
  </span>
  
  <%# Badge Emergencial/Cotações para OS tipo Diagnóstico %>
  <% if record.order_service_type_id == OrderServiceType::DIAGNOSTICO_ID %>
    <% 
      # Contar propostas aprovadas (não canceladas/reprovadas)
      approved_proposals_count = record.order_service_proposals
        .where.not(order_service_proposal_status_id: [
          OrderServiceProposalStatus::PROPOSTA_REPROVADA_ID,
          OrderServiceProposalStatus::CANCELADA_ID,
          OrderServiceProposalStatus::EM_CADASTRO_ID
        ])
        .count
    %>
    <% if approved_proposals_count == 1 %>
      <span class="badge badge-emergencial ms-1">
        <i class="bi bi-lightning-fill"></i> Emergencial
      </span>
    <% elsif approved_proposals_count > 1 %>
      <span class="badge badge-cotacoes-diag ms-1">
        <i class="bi bi-cart-check-fill"></i> Cotações
      </span>
    <% end %>
  <% end %>
<% else %>
  <span>-</span>
<% end %>
